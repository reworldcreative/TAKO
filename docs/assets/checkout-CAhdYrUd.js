import{g as X,i as f,b as y,c as M,J as q,d as F,p as S,e as k,h as w,o as L,a as E,s as $}from"./scale-n68OfTc5.js";const P="/TAKO/";function x(){const o=document.querySelectorAll('input[name="convenient-communication-method"]'),n=document.querySelectorAll(".checkout-form__delivery-content");function t(c){n.forEach(a=>{a.classList.toggle("active",a.dataset.method===c)})}const r=document.querySelector('input[name="convenient-communication-method"]:checked');r&&t(r.value),o.forEach(c=>{c.addEventListener("change",()=>{t(c.value)})})}async function A(){const o=await X(`${P}data/cities.json`);if(f(),y(o),M(".dropdown",["Опція 1","Опція 2","Опція 3"]),x(),typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("firefox")){const t=document.querySelector(".checkout-form__products");t.style.setProperty("scrollbar-width","thin"),t.style.setProperty("scrollbar-color","#0F5EBB transparent")}new q(".checkout-form").addField('[name="surname"]',[{rule:"required",errorMessage:"Прізвище обов’язкове"},{rule:"minLength",value:2,errorMessage:"Мінімум 2 символи"}]).addField('[name="name"]',[{rule:"required",errorMessage:"Ім’я обов’язкове"},{rule:"minLength",value:2,errorMessage:"Мінімум 2 символи"}]).addField('[name="middle-name"]',[{rule:"required",errorMessage:"По батькові обов’язкове"},{rule:"minLength",value:2,errorMessage:"Мінімум 2 символи"}]).addField('[name="phone"]',[{rule:"required",errorMessage:"Номер телефону обов’язковий"},{rule:"customFunction",validator:t=>{const r=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(r)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).addField('[name="address"]',[{rule:"required",errorMessage:"Адреса обов’язкова"},{rule:"customFunction",validator:(t,r)=>(o.includes(t.trim())?r['[name="branch-number"]'].elem.disabled=!1:r['[name="branch-number"]'].elem.disabled=!0,o.includes(t.trim())),errorMessage:"Населений пункт не знайдено"}]).addField('[name="branch-number"]',[{rule:"customFunction",validator:(t,r)=>r['[name="branch-number"]'].elem.disabled?!0:t.trim()!=="",errorMessage:"Номер відділення обов’язковий"}]).addField('[name="delivery-phone"]',[{rule:"customFunction",validator:t=>{var c;return((c=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:c.value)!=="phone"?!0:t.trim()!==""},errorMessage:"Номер телефону обов’язковий"},{rule:"customFunction",validator:t=>{const r=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(r)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).addField('[name="delivery-viber"]',[{rule:"customFunction",validator:t=>{var c;return((c=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:c.value)!=="viber"?!0:t.trim()!==""},errorMessage:"Номер viber обов’язковий"},{rule:"customFunction",validator:t=>{const r=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(r)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).addField('[name="delivery-telegram"]',[{rule:"customFunction",validator:t=>{var c;return((c=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:c.value)!=="telegram"?!0:t.trim()!==""},errorMessage:"Номер telegram обов’язковий"},{rule:"customFunction",validator:t=>{var l;if(((l=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:l.value)!=="telegram")return!0;const c=t.trim();if(!c)return!1;const a=c.replace(/[^\d]/g,""),i=/^380\d{9}$/.test(a),d=/^@?[\w\d_]{3,32}$/.test(c);return i||d},errorMessage:"Введіть номер у форматі +380XXXXXXXXX або нік"}]).addField('[name="delivery-whatsup"]',[{rule:"customFunction",validator:t=>{var c;return((c=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:c.value)!=="whatsup"?!0:t.trim()!==""},errorMessage:"Номер whatsup обов’язковий"},{rule:"customFunction",validator:t=>{const r=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(r)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).addField('[name="delivery-signal"]',[{rule:"customFunction",validator:t=>{var c;return((c=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:c.value)!=="signal"?!0:t.trim()!==""},errorMessage:"Номер signal обов’язковий"},{rule:"customFunction",validator:t=>{const r=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(r)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).onSuccess(t=>{t.preventDefault();const r=e.target,c=new FormData(r),a=Object.fromEntries(c.entries()),i=document.querySelector(".checkout-form__price-value").textContent.trim().replace(",","."),d=document.querySelectorAll(".product-card"),l=Array.from(d).map(u=>{var m,_;const p=u.dataset.id,h=((m=u.querySelector(".product-card__title"))==null?void 0:m.textContent.trim())||"",v=((_=u.querySelector(".product-card__counter-input"))==null?void 0:_.value)||0;return{id:p,title:h,quantity:Number(v)}});a.products=l,a.totalPrice=i,window.scrollTo({top:0,behavior:"auto"}),document.querySelector(".checkout-success").classList.add("show"),F(),localStorage.setItem("checkoutProducts",""),console.log(a)})}function C(o){const n=document.createElement("div");return n.className="product-card",n.dataset.id=o.id,n.innerHTML=`
    <picture class="product-card__image ">
        <source type="image/webp" srcset="${o.image.replace(/\.\w+$/,".webp")}">
        <source srcset="${o.image}">
    
        <img src="${o.image}" alt="product" class="product-card__image" draggable="false" width="124" height="124" loading="lazy">
    </picture>
    <div class="product-card__top">
      <p class="product-card__title">${o.name}</p>
  
      <button class="product-card__trash-button" type="button" aria-label="delete product">
        <svg class="product-card__trash-icon">
          <use xlink:href="#trash-can"></use>
        </svg>
      </button>
    </div>
  
    <div class="product-card__bottom">
      <div class="counter product-card__counter">
        <button type="button" class="product-card__counter-button decrement" disabled="" aria-label="decrement counter">
          <svg class="product-card__counter-icon">
            <use xlink:href="#nimus"></use>
          </svg>
        </button>
        <input class="input product-card__counter-input" type="number" value="${o.quantity}" min="1" aria-label="product counter">
        <button type="button" class="product-card__counter-button increment" aria-label="increment counter">
          <svg class="product-card__counter-icon">
            <use xlink:href="#plus"></use>
          </svg>
        </button>
      </div>
  
      <div class="product-card__price">
        <p class="product-card__price-container">
          <span class="product-card__price-value">${o.price}</span><span class="product-card__price-small">грн</span>
        </p>
        <p class="product-card__price-text">собівартість за од.</p>
      </div>
    </div>
  `,n}function N(){const o=JSON.parse(localStorage.getItem("checkoutProducts")),n=document.querySelector(".checkout-form__products"),t=document.querySelector(".checkout-form__preorder"),r=document.querySelector(".checkout-form__second-block_mobile"),c=document.querySelector(".checkout-form__price-value");o.forEach(s=>{n.appendChild(C(s))}),n.forEach(s=>{S(s)});const a=()=>{const s=n.querySelectorAll(".product-card");let u=0;if(s.forEach(p=>{const h=p.querySelector(".product-card__counter-input"),v=p.querySelector(".product-card__price-value"),m=parseInt(h.value,10),b=v.textContent.trim().replace(",",".").replace(/[^\d.]/g,""),g=parseFloat(b);!isNaN(m)&&!isNaN(g)&&(u+=m*g)}),c.textContent=u.toFixed(2).replace(".",","),s.length===0){t.classList.add("empty"),r.classList.add("empty");return}t.classList.remove("empty"),r.classList.remove("empty")},i=s=>{s.querySelector(".product-card__counter-input").addEventListener("input",a)},d=()=>{n.querySelectorAll(".product-card").forEach(u=>{i(u)})};new MutationObserver(()=>{d(),a()}).observe(n,{childList:!0}),d(),k(document.querySelector(".checkout-form__products"),()=>{a()}),a()}document.addEventListener("DOMContentLoaded",()=>{const o=[{selector:".header",callback:()=>{E([".header__products-button",".header__button-contacts",".header__button-support",".header__button-badge"],".header",.3,.1),$([".header__logo",".navigation__link"],".header",.5,.2)}}];w(),A(),N(),o.forEach(({selector:n,callback:t})=>{L(n,t)})});
