import{i as y,s as g,c as b,J as q,d as M,h as S}from"./header-DFY61aB2.js";const F="/TAKO/";async function _(c){try{return await(await fetch(c)).json()}catch(s){throw console.error(s),s}}function L(){const c=document.querySelectorAll('input[name="convenient-communication-method"]'),s=document.querySelectorAll(".checkout-form__delivery-content");function t(r){s.forEach(n=>{n.classList.toggle("active",n.dataset.method===r)})}const o=document.querySelector('input[name="convenient-communication-method"]:checked');o&&t(o.value),c.forEach(r=>{r.addEventListener("change",()=>{t(r.value)})})}async function k(){const c=await _(`${F}data/cities.json`);if(y(),g(c),b(".dropdown",["Опція 1","Опція 2","Опція 3"]),L(),typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("firefox")){const t=document.querySelector(".checkout-form__products");t.style.setProperty("scrollbar-width","thin"),t.style.setProperty("scrollbar-color","#0F5EBB transparent")}new q(".checkout-form").addField('[name="surname"]',[{rule:"required",errorMessage:"Прізвище обов’язкове"},{rule:"minLength",value:2,errorMessage:"Мінімум 2 символи"}]).addField('[name="name"]',[{rule:"required",errorMessage:"Ім’я обов’язкове"},{rule:"minLength",value:2,errorMessage:"Мінімум 2 символи"}]).addField('[name="middle-name"]',[{rule:"required",errorMessage:"По батькові обов’язкове"},{rule:"minLength",value:2,errorMessage:"Мінімум 2 символи"}]).addField('[name="phone"]',[{rule:"required",errorMessage:"Номер телефону обов’язковий"},{rule:"customFunction",validator:t=>{const o=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(o)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).addField('[name="address"]',[{rule:"required",errorMessage:"Адреса обов’язкова"},{rule:"customFunction",validator:(t,o)=>(c.includes(t.trim())?o['[name="branch-number"]'].elem.disabled=!1:o['[name="branch-number"]'].elem.disabled=!0,c.includes(t.trim())),errorMessage:"Населений пункт не знайдено"}]).addField('[name="branch-number"]',[{rule:"customFunction",validator:(t,o)=>o['[name="branch-number"]'].elem.disabled?!0:t.trim()!=="",errorMessage:"Номер відділення обов’язковий"}]).addField('[name="delivery-phone"]',[{rule:"customFunction",validator:t=>{var r;return((r=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:r.value)!=="phone"?!0:t.trim()!==""},errorMessage:"Номер телефону обов’язковий"},{rule:"customFunction",validator:t=>{const o=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(o)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).addField('[name="delivery-viber"]',[{rule:"customFunction",validator:t=>{var r;return((r=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:r.value)!=="viber"?!0:t.trim()!==""},errorMessage:"Номер viber обов’язковий"},{rule:"customFunction",validator:t=>{const o=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(o)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).addField('[name="delivery-telegram"]',[{rule:"customFunction",validator:t=>{var r;return((r=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:r.value)!=="telegram"?!0:t.trim()!==""},errorMessage:"Номер telegram обов’язковий"},{rule:"customFunction",validator:t=>{var a;if(((a=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:a.value)!=="telegram")return!0;const r=t.trim();if(!r)return!1;const n=r.replace(/[^\d]/g,""),u=/^380\d{9}$/.test(n),l=/^@?[\w\d_]{3,32}$/.test(r);return u||l},errorMessage:"Введіть номер у форматі +380XXXXXXXXX або нік"}]).addField('[name="delivery-whatsup"]',[{rule:"customFunction",validator:t=>{var r;return((r=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:r.value)!=="whatsup"?!0:t.trim()!==""},errorMessage:"Номер whatsup обов’язковий"},{rule:"customFunction",validator:t=>{const o=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(o)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).addField('[name="delivery-signal"]',[{rule:"customFunction",validator:t=>{var r;return((r=document.querySelector('input[name="convenient-communication-method"]:checked'))==null?void 0:r.value)!=="signal"?!0:t.trim()!==""},errorMessage:"Номер signal обов’язковий"},{rule:"customFunction",validator:t=>{const o=t.replace(/[^\d]/g,"");return/^380\d{9}$/.test(o)},errorMessage:"Введіть номер у форматі +380XXXXXXXXX"}]).onSuccess(t=>{t.preventDefault();const o=e.target,r=new FormData(o),n=Object.fromEntries(r.entries()),u=document.querySelector(".checkout-form__price-value").textContent.trim().replace(",","."),l=document.querySelectorAll(".product-card"),a=Array.from(l).map(d=>{var f,p;const v=d.dataset.id,h=((f=d.querySelector(".product-card__title"))==null?void 0:f.textContent.trim())||"",m=((p=d.querySelector(".product-card__counter-input"))==null?void 0:p.value)||0;return{id:v,title:h,quantity:Number(m)}});n.products=a,n.totalPrice=u,window.scrollTo({top:0,behavior:"auto"}),document.querySelector(".checkout-success").classList.add("show"),M(),console.log(n)})}function w(){const c=document.querySelectorAll(".counter");c.length&&c.forEach(s=>{const t=s.querySelector(".decrement"),o=s.querySelector(".increment"),r=s.querySelector(".input");t.addEventListener("click",()=>{r.stepDown(),r.dispatchEvent(new Event("input"))}),o.addEventListener("click",()=>{r.stepUp(),r.dispatchEvent(new Event("input"))}),r.addEventListener("input",()=>{let n=parseInt(r.value,10);(isNaN(n)||n<1)&&(n=1,r.value=n),n>1?t.removeAttribute("disabled"):t.setAttribute("disabled","")})})}function E(){const c=document.querySelectorAll(".product-card");c.length&&(c.forEach(s=>s.querySelector(".product-card__trash-button").addEventListener("click",()=>s.remove())),w())}function A(c){const s=document.querySelector(".checkout-form__products");new MutationObserver(o=>{o.forEach(r=>{r.removedNodes.forEach(n=>{n.classList&&n.classList.contains("product-card")&&c(n)})})}).observe(s,{childList:!0})}function P(){E();const c=document.querySelector(".checkout-form__products"),s=document.querySelector(".checkout-form__preorder"),t=document.querySelector(".checkout-form__second-block_mobile"),o=document.querySelector(".checkout-form__price-value"),r=()=>{const a=c.querySelectorAll(".product-card");let i=0;if(a.forEach(d=>{const v=d.querySelector(".product-card__counter-input"),h=d.querySelector(".product-card__price-value"),m=parseInt(v.value,10),p=h.textContent.trim().replace(",",".").replace(/[^\d.]/g,""),X=parseFloat(p);!isNaN(m)&&!isNaN(X)&&(i+=m*X)}),o.textContent=i.toFixed(2).replace(".",","),a.length===0){s.classList.add("empty"),t.classList.add("empty");return}s.classList.remove("empty"),t.classList.remove("empty")},n=a=>{a.querySelector(".product-card__counter-input").addEventListener("input",r)},u=()=>{c.querySelectorAll(".product-card").forEach(i=>{n(i)})};new MutationObserver(()=>{u(),r()}).observe(c,{childList:!0}),u(),A(()=>{r()}),r()}document.addEventListener("DOMContentLoaded",()=>{S(),k(),P()});
